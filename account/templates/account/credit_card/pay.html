{% extends 'web/base.html' %}


{% load staticfiles %}





    {% block header %}

        <link rel="stylesheet" href="{% static 'account/css/paymentInfo.css' %}">
        <link rel="stylesheet" href="{% static 'account/css/credit_card.css' %}">



        <script type="text/javascript">

            function setExpirationDate()
            {
                var exp = $("#card-expiration").val();
                if (exp.length > 0)
                {
                    var month = exp.split("/")[0];
                    var year = exp.split("/")[1];

                    $("#stripe-exp-month").val(month);
                    $("#stripe-exp-year").val(year);
                }
            }


            function setCardNumber()
            {
                var number = $("#card-number").val();
                $("#stripe-card-number").val(number);
            }


            function setCVC()
            {
                var cvc = $("#card-cvv").val();
                $("#stripe-card-cvc").val(cvc);
            }

        </script>

    {% endblock %}



{% block content %}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li {% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}
<!--=== Profile ===-->
<div class="container content profile">
    <div class="row">




        <div class="col-md-12 credit_card_header">
           <h1>Dog Lovers</h1>
            <h2 class="event_price">$50</h2>

        </div>

        <!-- Profile Content -->
        <div class="col-md-12 card_container">

              <form method="POST" id="payment-form" class="credit_card_form hide" action="{% url 'account:credit_card_register' %}">

                    {% csrf_token %}

                   <div class="payment-errors"></div>
                      <fieldset class="credit-card-group">
                        <label for="card-number">Credit Card Number</label>
                        <input placeholder="1234 5678 9012 3456"  type="text" class="card-number" id="card-number">
                        <label for="card-number">Expiration Date</label>
                        <input placeholder="MM/YY"  type="text" class="card-expiration" id="card-expiration">

                        <label for="card-number">CVV Number</label>
                        <input placeholder="CVV"  type="text" class="card-cvv" id="card-cvv" >
                        <label for="card-number">Billing Zip Code</label>
                        <input placeholder="ZIP/PC" type="text" class="card-zip" id="card-zip">
                      </fieldset>
                        <input type="hidden" size="20" data-stripe="number" id="stripe-card-number">
                        <input type="hidden" size="4" data-stripe="cvc" id="stripe-card-cvc">
                        <input type="hidden" size="3" data-stripe="exp_month" id="stripe-exp-month">
                        <input type="hidden" size="3" data-stripe="exp_year" id="stripe-exp-year">

                    <div class="card_save_container">
                        <h5>You'll be charged 24 hours before the event starts.</h5>
                        <h5>Your card will be added to your profile. You can remove
                        it at any time by accessing your profile settings.</h5>
                        <input type="submit" class="submit btn-u rounded card_button" value="Submit Payment" id="payment-form-submit">
                    </div>
                </form>



                <!-- <form method="POST" id="payment-form" action="{% url 'account:credit_card_register' %}">
                            {% csrf_token %}
                            <span class="payment-errors"></span>

                            <div class="form-row">
                                <label>
                                    <span>Card Number</span>

                                </label>
                            </div>

                            <div class="form-row">
                                <label>
                                    <span>Expiration (MM/YY)</span>
                                    <input type="text" size="2" data-stripe="exp_month">
                                </label>
                                <span> / </span>
                                <input type="text" size="2" data-stripe="exp_year">
                            </div>

                            <div class="form-row">
                                <label>
                                    <span>CVC</span>
                                    <input type="text" size="4" data-stripe="cvc">
                                </label>
                            </div>
                            <input type="submit" class="submit btn-u rounded" value="Register a credit card" id="payment-form-submit">
                            <strong>You will not be charged at this point, only when you participate in an event.</strong>
                        </form>
-->

        </div>






        <!-- End Profile Content -->
    </div>


    <!--=== Profile ===-->



    <!--=== End Profile ===-->


</div>
<!--=== End Profile ===-->


{% endblock %}


{% block javascript %}



<script type="text/javascript" src="{% static 'account/lib/jquery.inputmask.js' %}"></script>
<script type="text/javascript" src="{% static 'account/lib/jquery.inputmask.date.extensions.js' %}"></script>
<script type="text/javascript" src="{% static 'account/lib/min/modernizr-ck.js' %}"></script>
<script type="text/javascript" src="{% static 'account/js/app.js' %}"></script>

<script type="text/javascript" src="https://js.stripe.com/v2/"></script>
<script type="text/javascript">
  // Stripe functionality
  Stripe.setPublishableKey('pk_test_UiyVevDApASul2gRmo7TcDjF');

  $(function() {
    var $form = $('#payment-form');

    $form.submit(function(event) {
        setExpirationDate();
        setCVC();
      // Disable the submit button to prevent repeated clicks:
      $form.find('.submit').prop('disabled', true);

      // Request a token from Stripe:
      Stripe.card.createToken($form, stripeResponseHandler);

      // Prevent the form from being submitted:
      return false;
    });
  });

  // Validation helpers
  // card.validateCardNumber
  // card.validateExpiry
  // card.validateCVC
  // card.cardType

  function stripeResponseHandler(status, response) {
    // Grab the form:
    var $form = $('#payment-form');

    if (response.error) { // Problem!
      // Show the errors on the form:
      $form.find('.payment-errors').text(response.error.message);
      $form.find('.submit').prop('disabled', false); // Re-enable submission
    } else { // Token was created!
      // Get the token ID:
      var token = response.id;

      // Insert the token ID into the form so it gets submitted to the server:
      $form.append($('<input type="hidden" name="stripeToken">').val(token));

      // Submit the form:
      $form.get(0).submit();
  }
};

</script>

{% endblock %}